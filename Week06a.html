<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>The theoretical q-q</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs\style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Manipulation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 02</li>
    <li>
      <a href="Week02a.html">Data types</a>
    </li>
    <li>
      <a href="Week02b.html">Reading and writing data files</a>
    </li>
    <li>
      <a href="Week02c.html">Working with date objects</a>
    </li>
    <li>
      <a href="Week02d.html">Exploring and cleaning dataframes using base functions</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 03</li>
    <li>
      <a href="Week03a.html">Manipulating dataframes with dplyr</a>
    </li>
    <li>
      <a href="Week03d.html">Working with string objects</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 04</li>
    <li>
      <a href="Week03ab_groupby.html">Grouping and summarizing tables</a>
    </li>
    <li>
      <a href="Week03b.html">Tidying/reshaping tables using tidyr</a>
    </li>
    <li>
      <a href="Week03c.html">Joining data tables</a>
    </li>
    <li>
      <a href="Week03ab_examples.html">Example of data manipulation workflows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 05</li>
    <li>
      <a href="Week04a.html">The base plotting environment</a>
    </li>
    <li>
      <a href="Week04b.html">The lattice plotting environment</a>
    </li>
    <li>
      <a href="Week04c.html">The ggplot plotting environment</a>
    </li>
    <li>
      <a href="Week04d.html">Manipulating colors in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Univariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 06</li>
    <li>
      <a href="Week05a.html">Visualizing univariate data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 07</li>
    <li>
      <a href="Week05b.html">Comparing univariate data distributions</a>
    </li>
    <li>
      <a href="Week06a.html">Theoretical Q-Q plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 08</li>
    <li>
      <a href="Week07a.html">Fits and residuals</a>
    </li>
    <li>
      <a href="Week07b.html">Spread-location plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 09</li>
    <li>
      <a href="Week08a.html">Re-expressing data</a>
    </li>
    <li>
      <a href="Week08b.html">Letter value summaries</a>
    </li>
    <li>
      <a href="Week08c.html">The Two R’s of EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bivariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 10</li>
    <li>
      <a href="Week09a.html">Bivariate analysis</a>
    </li>
    <li>
      <a href="Week09b.html">Resistant lines</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 11</li>
    <li>
      <a href="Week10a.html">The third R of EDA: Residuals</a>
    </li>
    <li>
      <a href="Week10b.html">Detecting discontinuities in the data</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/regression.html">Details of the OLS regression method (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Two-way tables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 12</li>
    <li>
      <a href="Week11a.html">Median polish/Mean polish</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/ANOVA.html">Details of an ANOVA (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 13</li>
    <li>
      <a href="Week12a.html">Creating maps in R</a>
    </li>
    <li class="dropdown-header">Connecting to relational databases</li>
  </ul>
</li>
<li>
  <a href="Data.html">Datasets</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CSource+Code+Pro" rel="stylesheet">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">The theoretical q-q</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#the-normal-q-q-plot">The normal q-q plot</a><ul>
<li><a href="#drawing-a-normal-q-q-plot-from-scratch">Drawing a normal q-q plot from scratch</a></li>
<li><a href="#using-rs-built-in-functions">Using R’s built-in functions</a></li>
<li><a href="#using-the-ggplot2-plotting-environment">Using the ggplot2 plotting environment</a></li>
</ul></li>
</ul>
</div>

<div style="color:#ff7535; background-color:#fff0ee ;   border-left-style: solid">
<p>This tutorial makes use of the following R package(s): <strong><code>ggplot2</code></strong>, <strong><code>dplyr</code></strong>, <strong><code>lattice</code></strong> (for data only).</p>
<p>This material can be read in conjunction with <strong>section 2.4</strong> of <strong>Cleveland’s book</strong>.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Thus far, we have used the quantile-quantile plots to compare the distributions between two empirical (i.e. observational) datasets. We can also use the q-q plot to compare an empirical observation to a theoretical observation (i.e. one defined mathematically). Examples of popular theoretical observations are the normal distribution (aka the Gaussian distribution), the chi-square distribution, and the exponential distribution just to name a few.</p>
<p><img src="Week06a_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>There are many reasons we might want to compare empirical data to theoretical distributions:</p>
<ul>
<li><p>A theoretical distribution is easy to parameterize. For example, if the shape of the distribution of a batch of numbers can be approximated by a normal distribution we can reduce the complexity of our data to just two values: the mean and the standard deviation.</p></li>
<li><p>If data can be approximated by certain theoretical distributions, then many mainstream statistical procedures can be applied to the data.</p></li>
<li><p>In inferential statistics, knowing that a sample was derived from a population whose distribution follows a theoretical distribution allows us to derive certain properties of the population from the sample. For example, if we know that a sample comes from a normally distributed population, we can define confidence intervals for the sample mean using a t-distribution.</p></li>
<li><p>Modeling the distribution of the observed data can provide insight into the underlying process that generated the data.</p></li>
</ul>
<p>But very few empirical datasets follow any theoretical distributions exactly. So the questions usually ends up being “how well does theoretical distribution <em>X</em> fit my data?”</p>
<p>The theoretical quantile-quantile plot is a tool to explore how a batch of numbers deviates from a theoretical distribution and to visually assess whether the difference is significant for the purpose of the analysis. In the following examples, we will compare empirical data to the normal distribution using the <strong>normal quantile-quantile</strong> plot.</p>
</div>
<div id="the-normal-q-q-plot" class="section level1">
<h1>The normal q-q plot</h1>
<p>The <em>normal q-q plot</em> is just a special case of the <em>empirical q-q plot</em> we’ve explored so far; the difference being that we assign the normal distribution quantiles to the x-axis.</p>
<div id="drawing-a-normal-q-q-plot-from-scratch" class="section level2">
<h2>Drawing a normal q-q plot from scratch</h2>
<p>In the following example, we’ll compare the <code>Alto 1</code> group to a normal distribution. First, we’ll extract the <code>Alto 1</code> height values and save them as an atomic vector object using <code>dplyr</code>’s piping operations. However, <code>dplyr</code>’s operations will return a dataframe–even if a single column is select. To force the output to an atomic vector, we’ll pipe the subset to <code>.$height</code> which will extract the <code>height</code> column into a plain vector element.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)

df   &lt;-<span class="st"> </span>lattice<span class="op">::</span>singer
alto &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">filter</span>(voice.part <span class="op">==</span><span class="st"> &quot;Alto 1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>height</code></pre></div>
<p>Next, we need to sort <code>alto</code> in ascending order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alto &lt;-<span class="st"> </span><span class="kw">sort</span>(alto)</code></pre></div>
<p>Next, we need to find the matching normal distribution quantiles. We first find the quantiles for <code>alto</code>, then use <code>qnorm</code> to find the matching normal distribution values from the quantiles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i      &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alto)
fi     &lt;-<span class="st"> </span>(i <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(alto)
x.norm &lt;-<span class="st"> </span><span class="kw">qnorm</span>(fi)</code></pre></div>
<p>Now we can plot the sorted <code>alto</code> values against the normal values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( alto <span class="op">~</span><span class="st"> </span>x.norm, <span class="dt">type=</span><span class="st">&quot;p&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Normal quantiles&quot;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</code></pre></div>
<p><img src="Week06a_files/figure-html/unnamed-chunk-6-1.png" width="288" /></p>
<p>When comparing a batch of numbers to a theoretical distribution on a q-q plot, we are looking for significant deviation from a straight line. To make it easier to judge straightness, we can fit a line to the points. Note that we are <strong>not</strong> creating a 45° (or x=y) slope; the range of values between both sets of numbers do not match. Here, we are only seeking the <strong>straightness</strong> of the points.</p>
<p>There are many ways one can fit a line to the data, Cleveland opts to fit a line to the first and third quartile of the q-q plot. The following chunk of code identifies the quantiles for both the <code>alto</code> dataset and the theoretical normal distribution. It then computes the slope and intercept for that line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Find 1st and 3rd quartile for the Alto 1 data</span>
y &lt;-<span class="st"> </span><span class="kw">quantile</span>(alto, <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))

<span class="co"># Find the 1st and 3rd quartile of the normal distribution</span>
x &lt;-<span class="st"> </span><span class="kw">qnorm</span>( <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))

<span class="co"># Now we can compute the intercept and slope of the line that passes</span>
<span class="co"># through these points</span>
slope &lt;-<span class="st"> </span><span class="kw">diff</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">diff</span>(x)
int   &lt;-<span class="st"> </span>y[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>x[<span class="dv">1</span>]</code></pre></div>
<p>Next, we add the line to the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">abline</span>(<span class="dt">a=</span>int, <span class="dt">b=</span>slope )</code></pre></div>
<p><img src="Week06a_files/figure-html/unnamed-chunk-8-1.png" width="288" /></p>
</div>
<div id="using-rs-built-in-functions" class="section level2">
<h2>Using R’s built-in functions</h2>
<p>R has two built-in functions that facilitate the plot building task when comparing a batch to a normal distribution: <code>qqnorm</code> and <code>qqline</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(alto)
<span class="kw">qqline</span>(alto)</code></pre></div>
<p><img src="Week06a_files/figure-html/unnamed-chunk-9-1.png" width="288" /></p>
<p>That’s it. Just two lines of code!</p>
</div>
<div id="using-the-ggplot2-plotting-environment" class="section level2">
<h2>Using the ggplot2 plotting environment</h2>
<p>We can take advantage of the <code>stat_qq()</code> function to plot the points, but the equation for the line must be computed manually (as was done earlier). Those steps will be repeated here.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)

<span class="co"># Find the slope and intercept of the line that passes through the 1st and 3rd</span>
<span class="co"># quartile of the normal q-q plot</span>

y     &lt;-<span class="st"> </span><span class="kw">quantile</span>(alto, <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)) <span class="co"># Find the 1st and 3rd quartiles</span>
x     &lt;-<span class="st"> </span><span class="kw">qnorm</span>( <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))         <span class="co"># Find the matching normal values on the x-axis</span>
slope &lt;-<span class="st"> </span><span class="kw">diff</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">diff</span>(x)             <span class="co"># Compute the line slope</span>
int   &lt;-<span class="st"> </span>y[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>x[<span class="dv">1</span>]           <span class="co"># Compute the line intercept</span>

<span class="co"># Generate normal q-q plot</span>

<span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">sample=</span>alto) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>(<span class="dt">distribution=</span>qnorm) <span class="op">+</span><span class="st"> </span>
<span class="st">           </span><span class="kw">geom_abline</span>(<span class="dt">intercept=</span>int, <span class="dt">slope=</span>slope) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Height&quot;</span>)           </code></pre></div>
<p><img src="Week06a_files/figure-html/unnamed-chunk-10-1.png" width="288" /></p>
<p>We can, of course, make use of <code>ggplot</code>’s faceting function to generate trellised plots. For example, the following plot replicates Cleveland’s figure 2.11 (except for the layout which we’ll setup as a single row of plots instead). But first, we will need to compute the slopes for each singer group. We’ll use <code>dplyr</code>’s piping operations to create a new dataframe with singer group name, slope and intercept.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
intsl &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(voice.part) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">       </span><span class="kw">summarize</span>(<span class="dt">q25    =</span> <span class="kw">quantile</span>(height,<span class="fl">0.25</span>),
                 <span class="dt">q75    =</span> <span class="kw">quantile</span>(height,<span class="fl">0.75</span>),
                 <span class="dt">norm25 =</span> <span class="kw">qnorm</span>( <span class="fl">0.25</span>),
                 <span class="dt">norm75 =</span> <span class="kw">qnorm</span>( <span class="fl">0.75</span>),
                 <span class="dt">slope  =</span> (q25 <span class="op">-</span><span class="st"> </span>q75) <span class="op">/</span><span class="st"> </span>(norm25 <span class="op">-</span><span class="st"> </span>norm75),
                 <span class="dt">int    =</span> q25 <span class="op">-</span><span class="st"> </span>slope <span class="op">*</span><span class="st"> </span>norm25) <span class="op">%&gt;%</span>
<span class="st">       </span><span class="kw">select</span>(voice.part,slope, int) </code></pre></div>
<p>The above chunk creates the following table.</p>
<table style="width:39%;">
<colgroup>
<col width="18%" />
<col width="12%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">voice.part</th>
<th align="left">slope</th>
<th align="left">int</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bass 2</td>
<td align="left">2.965204</td>
<td align="left">72.000</td>
</tr>
<tr class="even">
<td align="left">Bass 1</td>
<td align="left">2.223903</td>
<td align="left">70.500</td>
</tr>
<tr class="odd">
<td align="left">Tenor 2</td>
<td align="left">1.482602</td>
<td align="left">70.000</td>
</tr>
<tr class="even">
<td align="left">Tenor 1</td>
<td align="left">3.706506</td>
<td align="left">68.500</td>
</tr>
<tr class="odd">
<td align="left">Alto 2</td>
<td align="left">2.223903</td>
<td align="left">65.500</td>
</tr>
<tr class="even">
<td align="left">Alto 1</td>
<td align="left">2.594554</td>
<td align="left">64.750</td>
</tr>
<tr class="odd">
<td align="left">Soprano 2</td>
<td align="left">2.779879</td>
<td align="left">63.875</td>
</tr>
<tr class="even">
<td align="left">Soprano 1</td>
<td align="left">1.667927</td>
<td align="left">63.875</td>
</tr>
</tbody>
</table>
<p>It’s important that the <code>voice.part</code> names match those in <code>df</code> letter-for-letter so that when <code>ggplot</code> is called, it will know which facet to assign the slope and intercept values to via <code>geom_abline</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">sample=</span>height)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq</span>(<span class="dt">distribution=</span>qnorm) <span class="op">+</span><span class="st"> </span>
<span class="st">           </span><span class="kw">geom_abline</span>(<span class="dt">data=</span>intsl, <span class="kw">aes</span>(<span class="dt">intercept=</span>int, <span class="dt">slope=</span>slope), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="op">+</span>
<span class="st">           </span><span class="kw">facet_wrap</span>(<span class="op">~</span>voice.part,<span class="dt">nrow=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Height&quot;</span>) </code></pre></div>
<p><img src="Week06a_files/figure-html/unnamed-chunk-13-1.png" width="864" /></p>
</div>
</div>


<div class="footer">
<hr/>
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>  Manny Gimond (2018)
</br>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
