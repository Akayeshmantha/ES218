<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Working with Dates</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs\style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Manipulation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 02</li>
    <li>
      <a href="Week02a.html">Data types</a>
    </li>
    <li>
      <a href="Week02b.html">Reading and writing data files</a>
    </li>
    <li>
      <a href="Week02c.html">Working with date objects</a>
    </li>
    <li>
      <a href="Week02d.html">Exploring and cleaning dataframes using base functions</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 03</li>
    <li>
      <a href="Week03a.html">Manipulating dataframes with dplyr</a>
    </li>
    <li>
      <a href="Week03d.html">Working with string objects</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 04</li>
    <li>
      <a href="Week03ab_groupby.html">Grouping and summarizing tables</a>
    </li>
    <li>
      <a href="Week03b.html">Tidying/reshaping tables using tidyr</a>
    </li>
    <li>
      <a href="Week03c.html">Joining data tables</a>
    </li>
    <li>
      <a href="Week03ab_examples.html">Example of data manipulation workflows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 05</li>
    <li>
      <a href="Week04a.html">The base plotting environment</a>
    </li>
    <li>
      <a href="Week04b.html">The lattice plotting environment</a>
    </li>
    <li>
      <a href="Week04c.html">The ggplot plotting environment</a>
    </li>
    <li>
      <a href="Week04d.html">Manipulating colors in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Univariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 06</li>
    <li>
      <a href="Week05a.html">Visualizing univariate data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 07</li>
    <li>
      <a href="Week05b.html">Comparing univariate data distributions</a>
    </li>
    <li>
      <a href="Week06a.html">Theoretical Q-Q plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 08</li>
    <li>
      <a href="Week07a.html">Fits and residuals</a>
    </li>
    <li>
      <a href="Week07b.html">Spread-location plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 09</li>
    <li>
      <a href="Week08a.html">Re-expressing data</a>
    </li>
    <li>
      <a href="Week08b.html">Letter value summaries</a>
    </li>
    <li>
      <a href="Week08c.html">The Two R’s of EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bivariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 10</li>
    <li>
      <a href="Week09a.html">Bivariate analysis</a>
    </li>
    <li>
      <a href="Week09b.html">Resistant lines</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 11</li>
    <li>
      <a href="Week10a.html">The third R of EDA: Residuals</a>
    </li>
    <li>
      <a href="Week10b.html">Detecting discontinuities in the data</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/regression.html">Details of the OLS regression method (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Two-way tables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 12</li>
    <li>
      <a href="Week11a.html">Median polish/Mean polish</a>
    </li>
    <li>
      <a href="http://mgimond.github.io/Stats-in-R/ANOVA.html">Details of an ANOVA (optional reading)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Misc01.html">R markdown documents</a>
    </li>
    <li class="dropdown-header">Week 13</li>
    <li>
      <a href="Week12a.html">Creating maps in R</a>
    </li>
    <li class="dropdown-header">Connecting to relational databases</li>
  </ul>
</li>
<li>
  <a href="Data.html">Datasets</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CSource+Code+Pro" rel="stylesheet">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Working with Dates</h1>

</div>


<div style="color:#ff7535; background-color:#fff0ee ;   border-left-style: solid">
<p>This tutorial makes use of the following R package(s): <strong><code>lubridate</code></strong> and <strong><code>stringr</code></strong>.</p>
</div>
<p>Date values can be represented in tables as numbers or characters. But to be properly interpreted by R as dates, date values should be converted to an R <strong>date</strong> object class or a <code>POSIXct</code>/<code>POSIXt</code> object class. R provides many facilities to convert and manipulate dates and times, but a package called <code>lubridate</code> makes working with dates/times much easier.</p>
<div id="creating-datetime-objects" class="section level1">
<h1>Creating date/time objects</h1>
<div id="from-complete-date-strings" class="section level2">
<h2>From complete date strings</h2>
<p>You can convert many representations of date and time to date objects. For example, let’s create a vector of dates represented as month/day/year character strings,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;06/23/2013&quot;</span>, <span class="st">&quot;06/30/2013&quot;</span>, <span class="st">&quot;07/12/2014&quot;</span>)
<span class="kw">class</span>(x)</code></pre></div>
<pre><code>[1] &quot;character&quot;</code></pre>
<p>At this point, R treats the vector <code>x</code> as characters. To force R to interpret these as dates, use <code>lubridate</code>’s <code>mdy</code> function. <code>mdy</code> will convert date strings where the date elements are ordered as month, day and year.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
x.date &lt;-<span class="st"> </span><span class="kw">mdy</span>(x)
<span class="kw">class</span>(x.date)</code></pre></div>
<pre><code>[1] &quot;Date&quot;</code></pre>
<p>Note that using the <code>mode</code> or <code>typeof</code> functions will not help us determine if the object is an R <em>date</em> object. This is because a date is stored as a <code>numeric</code> (double) internally. Use the <code>class</code> function instead as shown in the above code chunk.</p>
<p>If you need to specify the time zone, add the parameter <code>tz=</code>. For example, to specify <em>Eastern Standard Time</em>, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.date &lt;-<span class="st"> </span><span class="kw">mdy</span>(x, <span class="dt">tz=</span><span class="st">&quot;EST&quot;</span>)
x.date</code></pre></div>
<pre><code>[1] &quot;2013-06-23 EST&quot; &quot;2013-06-30 EST&quot; &quot;2014-07-12 EST&quot;</code></pre>
<p>R does not maintain its own list of timezone names, instead, it relies on the operating system’s naming convention. To list the supported timezone names for your particular R environment, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">OlsonNames</span>()</code></pre></div>
<p>For example, to select Daylight Savings Time type <code>tz=&quot;EST5DST&quot;</code>.</p>
<p>Adding the timezone converts the R date object into another date object class called <code>POSIXt</code> or <code>POSIXct</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x.date)</code></pre></div>
<pre><code>[1] &quot;POSIXct&quot; &quot;POSIXt&quot; </code></pre>
<p>Turning our attention back to the function <code>mdy</code>, note that it can read in date formats that use different delimiters so that <code>mdy(&quot;06/23/2013&quot;)</code>, <code>mdy(&quot;06-23-2013&quot;)</code> and <code>mdy(&quot;06.23.2013&quot;)</code> are parsed exactly the same so long as the order remains month/day/year.</p>
<p>For different month/day/year arrangements, other <code>lubridate</code> functions need to be used:</p>
<table>
<thead>
<tr class="header">
<th>Functions</th>
<th>Date Format</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dmy()</code></td>
<td>day/month/year</td>
</tr>
<tr class="even">
<td><code>ymd()</code></td>
<td>year/month/day</td>
</tr>
<tr class="odd">
<td><code>ydm()</code></td>
<td>year/day/month</td>
</tr>
</tbody>
</table>
<p>If your data contains both date <em>and</em> time in a “month/day/year hour:minutes:seconds” format use the <code>mdy_hms</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;06/23/2013 03:45:23&quot;</span>, <span class="st">&quot;07/30/2013 14:23:00&quot;</span>, <span class="st">&quot;08/12/2014 18:01:59&quot;</span>)
x.date &lt;-<span class="st"> </span><span class="kw">mdy_hms</span>(x, <span class="dt">tz=</span><span class="st">&quot;EST&quot;</span>)
x.date</code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:45:23 EST&quot; &quot;2013-07-30 14:23:00 EST&quot; &quot;2014-08-12 18:01:59 EST&quot;</code></pre>
<p>The characters <code>_h</code>, <code>_hm</code> or <code>_hms</code> can be appended to any of the four date function names described earlier to accommodate time formats. A few examples follow:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mdy_h</span>(<span class="st">&quot;6/23/2013 3&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;EST&quot;</span>) </code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:00:00 EST&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dmy_hm</span>(<span class="st">&quot;23/6/2013 3:15&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;EST&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:15:00 EST&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ymd_hms</span>(<span class="st">&quot;2013/06/23 3:15:7&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;EST&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:15:07 EST&quot;</code></pre>
<p>Note that adding a time element to the date object will also create <code>POSIXct</code> and <code>POSIXt</code> object classes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(x.date)</code></pre></div>
<pre><code>[1] &quot;POSIXct&quot; &quot;POSIXt&quot; </code></pre>
<p>Also, if a timezone is not explicitly defined for a time based date, the function assigns the <code>UTC</code> (universal time) time zone.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dmy_hm</span>(<span class="st">&quot;23/6/2013 3:15&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:15:00 UTC&quot;</code></pre>
</div>
<div id="from-separate-date-elements" class="section level2">
<h2>From separate date elements</h2>
<p>If your data table splits the date elements into separate vector objects or columns, use the <code>paste</code> function to combine the elements into a single date string before passing it to one of the lubridate functions. Let’s look at an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://mgimond.github.io/ES218/Data/CO2.csv&quot;</span>)
<span class="kw">head</span>(dat1)</code></pre></div>
<pre><code>  Year Month Average Interpolated  Trend Daily_mean
1 1959     1  315.62       315.62 315.70         -1
2 1959     2  316.38       316.38 315.88         -1
3 1959     3  316.71       316.71 315.62         -1
4 1959     4  317.72       317.72 315.56         -1
5 1959     5  318.29       318.29 315.50         -1
6 1959     6  318.15       318.15 315.92         -1</code></pre>
<p>The CO2 dataset has the date split across two columns: <code>Year</code> and <code>Month</code> (both stored as integers). You can combine the columns into a character string using the <code>paste</code> function. For example, if we want to create a “Year-Month” string as in <code>1959-10</code>, we could type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(dat1<span class="op">$</span>Year,dat1<span class="op">$</span>Month, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>)</code></pre></div>
<p>The above example uses three arguments: the two objects that are pasted together (i.e. <code>Year</code> and <code>Month</code>) and the <code>sep=&quot;-&quot;</code> parameter which fills the gap between both objects with a dash <code>-</code> (by default, <code>paste</code> would have added spaces thus creating strings in the form of <code>1959 10</code>).</p>
<p><code>lubridate</code> does not have a function along the lines of <code>ym</code> to convert just the year-month strings, this requires that we add an artificial day of the month to the string. We’ll choose to add the 15<sup>th</sup> day of the month as in</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">paste</span>(dat1<span class="op">$</span>Year, dat1<span class="op">$</span>Month, <span class="st">&quot;15&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>)</code></pre></div>
<p>And finally, we’ll add a new column called <code>Date</code> to the <code>dat</code> object, and fill that column with the newly created date string wrapped with the <code>ymd</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat1<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">ymd</span>( <span class="kw">paste</span>(dat1<span class="op">$</span>Year, dat1<span class="op">$</span>Month, <span class="st">&quot;15&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;-&quot;</span>) )
<span class="kw">head</span>(dat1)</code></pre></div>
<pre><code>  Year Month Average Interpolated  Trend Daily_mean       Date
1 1959     1  315.62       315.62 315.70         -1 1959-01-15
2 1959     2  316.38       316.38 315.88         -1 1959-02-15
3 1959     3  316.71       316.71 315.62         -1 1959-03-15
4 1959     4  317.72       317.72 315.56         -1 1959-04-15
5 1959     5  318.29       318.29 315.50         -1 1959-05-15
6 1959     6  318.15       318.15 315.92         -1 1959-06-15</code></pre>
<p>The <code>sep=&quot;-&quot;</code> option is not needed with the lubridate function so the last piece of code could have been written as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat1<span class="op">$</span>Date &lt;-<span class="st"> </span><span class="kw">ymd</span>( <span class="kw">paste</span>(dat1<span class="op">$</span>Year, dat1<span class="op">$</span>Month, <span class="st">&quot;15&quot;</span>) )</code></pre></div>
<p>To confirm that the <code>Date</code> column is indeed formatted as a date object type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(dat1)</code></pre></div>
<pre><code>&#39;data.frame&#39;:   671 obs. of  7 variables:
 $ Year        : int  1959 1959 1959 1959 1959 1959 1959 1959 1959 1959 ...
 $ Month       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Average     : num  316 316 317 318 318 ...
 $ Interpolated: num  316 316 317 318 318 ...
 $ Trend       : num  316 316 316 316 316 ...
 $ Daily_mean  : int  -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 ...
 $ Date        : Date, format: &quot;1959-01-15&quot; &quot;1959-02-15&quot; &quot;1959-03-15&quot; &quot;1959-04-15&quot; ...</code></pre>
<p>or you could type,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(dat1<span class="op">$</span>Date)</code></pre></div>
<pre><code>[1] &quot;Date&quot;</code></pre>
<p>Since we did not add a timezone or a time component to the date object the <code>Date</code> column was assigned a <code>Date</code> class as opposed to the <code>POSIX...</code> class.</p>
</div>
<div id="padding-time-values" class="section level2">
<h2>Padding time values</h2>
<p>The lubridate functions may expect the time values to consist of a specific number of characters if a delimiter such as <code>:</code> is not present to split the time elements. For example, the following will not generate a valide date/time object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hrmin &lt;-<span class="st"> </span><span class="dv">712</span>           <span class="co"># Time 7:12</span>
date  &lt;-<span class="st"> &quot;2018/03/17&quot;</span>  <span class="co"># Date </span>
<span class="kw">ymd_hm</span>(<span class="kw">paste</span>(date, hrmin))</code></pre></div>
<pre><code>[1] NA</code></pre>
<p>One solution is to <em>pad</em> the time element with 0’s to complete a four character vector (or a six character vector if seconds are part of the time element). We can use the <code>str_pad</code> function from the <code>stringr</code> package to pad the time object (the <code>stringr</code> package is covered <a href="https://mgimond.github.io/ES218/Week03d.html">in Week 4</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stringr)
<span class="kw">ymd_hm</span>(<span class="kw">paste</span>(date, <span class="kw">str_pad</span>(hrmin, <span class="dt">width=</span><span class="dv">4</span>, <span class="dt">pad=</span><span class="st">&quot;0&quot;</span>)))</code></pre></div>
<pre><code>[1] &quot;2018-03-17 07:12:00 UTC&quot;</code></pre>
</div>
</div>
<div id="extracting-date-information" class="section level1">
<h1>Extracting date information</h1>
<p>If you want to extract the day of the week from a date vector, use the <code>wday</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wday</span>(x.date)</code></pre></div>
<pre><code>[1] 1 3 3</code></pre>
<p>If you want the day of the week displayed as its three letter designation, add the <code>label=TRUE</code> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wday</span>(x.date, <span class="dt">label=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>[1] Sun Tue Tue
Levels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat</code></pre>
<p>You’ll note that the function returns a <code>factor</code> object with seven levels–one for each day of the week (Sun, Mon, Tue, Wed, Thu, Fri, Sat)–as well as the level hierarchy which will dictate the order in which values will be displayed if grouped by this factor. The levels are not necessarily reflected in the vector elements (only Sun, Tue are present), but the levels are there if we were ever to add addition day elements to this vector.</p>
<p>The following table lists functions that extract different elements of a date object.</p>
<table>
<thead>
<tr class="header">
<th>Functions</th>
<th>Extracted element</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>hour()</code></td>
<td>Hour of the day</td>
</tr>
<tr class="even">
<td><code>minute()</code></td>
<td>Minute of the hour</td>
</tr>
<tr class="odd">
<td><code>day()</code></td>
<td>Day of the month</td>
</tr>
<tr class="even">
<td><code>yday()</code></td>
<td>Day of the year</td>
</tr>
<tr class="odd">
<td><code>decimal_date()</code></td>
<td>Decimal year</td>
</tr>
<tr class="even">
<td><code>month()</code></td>
<td>Month of the year</td>
</tr>
<tr class="odd">
<td><code>year()</code></td>
<td>Year</td>
</tr>
<tr class="even">
<td><code>tz()</code></td>
<td>Time zone</td>
</tr>
</tbody>
</table>
</div>
<div id="operating-on-dates" class="section level1">
<h1>Operating on dates</h1>
<p>You can apply certain operations to dates as you would to numbers. For example, to list the number of days between the first and third elements of the vector <code>x.date</code> type the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(x.date[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>x.date[<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">ddays</span>()</code></pre></div>
<pre><code>[1] 415.5949</code></pre>
<p>To get the number of weeks between both dates:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(x.date[<span class="dv">3</span>] <span class="op">-</span><span class="st"> </span>x.date[<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">dweeks</span>()</code></pre></div>
<pre><code>[1] 59.37069</code></pre>
<p>Likewise, you can get the number of minutes between dates by dividing by <code>dminutes()</code> and the number of years by dividing by <code>dyears()</code>.</p>
<p>You can also apply Boolean operations on dates. For example, to find which date element in <code>x.date</code> falls between the 11<sup>th</sup> and 24<sup>th</sup> day of any month, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">mday</span>(x.date) <span class="op">&gt;</span><span class="st"> </span><span class="dv">11</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">mday</span>(x.date) <span class="op">&lt;</span><span class="st"> </span><span class="dv">24</span>)</code></pre></div>
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
<p>If you want the command to return just the dates that satisfy this query, pass the Boolean operation as an index to the <code>x.date</code> vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x.date[ (<span class="kw">mday</span>(x.date) <span class="op">&gt;</span><span class="st"> </span><span class="dv">11</span>) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">mday</span>(x.date) <span class="op">&lt;</span><span class="st"> </span><span class="dv">24</span>) ]</code></pre></div>
<pre><code>[1] &quot;2013-06-23 03:45:23 EST&quot; &quot;2014-08-12 18:01:59 EST&quot;</code></pre>
</div>
<div id="formatting-date-objects" class="section level1">
<h1>Formatting date objects</h1>
<p>You can create a character vector from a date object. This is useful if you want to annotate plots with dates or include date values in reports. For example, to convert the date object <code>x.date</code> to a “Month_name Year” character format, type the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.character</span>(x.date, <span class="dt">format=</span><span class="st">&quot;%B %Y&quot;</span>)</code></pre></div>
<pre><code>[1] &quot;June 2013&quot;   &quot;July 2013&quot;   &quot;August 2014&quot;</code></pre>
<p>The <code>format=</code> parameter accepts many different date/time format codes listed in the following table (note the case!).</p>
<table>
<colgroup>
<col width="17%" />
<col width="31%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Format codes</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>%a</code></td>
<td>Abbreviated weekday name</td>
<td>Sun, Tue, Tue</td>
</tr>
<tr class="even">
<td><code>%A</code></td>
<td>Full weekday name</td>
<td>Sunday, Tuesday, Tuesday</td>
</tr>
<tr class="odd">
<td><code>%m</code></td>
<td>Month as decimal number</td>
<td>06, 07, 08</td>
</tr>
<tr class="even">
<td><code>%b</code></td>
<td>Abbreviated month name</td>
<td>Jun, Jul, Aug</td>
</tr>
<tr class="odd">
<td><code>%B</code></td>
<td>Full month name</td>
<td>June, July, August</td>
</tr>
<tr class="even">
<td><code>%c</code></td>
<td>Date and time, locale-specific</td>
<td>Sun Jun 23 03:45:23 2013, Tue Jul 30 14:23:00 2013, Tue Aug 12 18:01:59 2014</td>
</tr>
<tr class="odd">
<td><code>%d</code></td>
<td>Day of the month as decimal number</td>
<td>23, 30, 12</td>
</tr>
<tr class="even">
<td><code>%H</code></td>
<td>Hours as decimal number (00 to 23)</td>
<td>03, 14, 18</td>
</tr>
<tr class="odd">
<td><code>%I</code></td>
<td>Hours as decimal number (01 to 12)</td>
<td>03, 02, 06</td>
</tr>
<tr class="even">
<td><code>%p</code></td>
<td>AM/PM indicator in the locale</td>
<td>AM, PM, PM</td>
</tr>
<tr class="odd">
<td><code>%j</code></td>
<td>Day of year as decimal number</td>
<td>174, 211, 224</td>
</tr>
<tr class="even">
<td><code>%M</code></td>
<td>Minute as decimal number (00 to 59)</td>
<td>45, 23, 01</td>
</tr>
<tr class="odd">
<td><code>%S</code></td>
<td>Second as decimal number</td>
<td>23, 00, 59</td>
</tr>
<tr class="even">
<td><code>%U</code></td>
<td>Week of the year starting on the first Sunday</td>
<td>25, 30, 32</td>
</tr>
<tr class="odd">
<td><code>%W</code></td>
<td>Week of the year starting on the first Monday</td>
<td>24, 30, 32</td>
</tr>
<tr class="even">
<td><code>%w</code></td>
<td>Weekday as decimal number (Sunday = 0)</td>
<td>0, 2, 2</td>
</tr>
<tr class="odd">
<td><code>%x</code></td>
<td>Date (locale-specific)</td>
<td>6/23/2013, 7/30/2013, 8/12/2014</td>
</tr>
<tr class="even">
<td><code>%X</code></td>
<td>Time (locale-specific)</td>
<td>3:45:23 AM, 2:23:00 PM, 6:01:59 PM</td>
</tr>
<tr class="odd">
<td><code>%Y</code></td>
<td>4-digit year</td>
<td>2013, 2013, 2014</td>
</tr>
<tr class="even">
<td><code>%y</code></td>
<td>2-digit year</td>
<td>13, 13, 14</td>
</tr>
<tr class="odd">
<td><code>%Z</code></td>
<td>Abbreviated time zone</td>
<td>EST, EST, EST</td>
</tr>
<tr class="even">
<td><code>%z</code></td>
<td>Time zone</td>
<td>-0500, -0500, -0500</td>
</tr>
</tbody>
</table>
</div>


<div class="footer">
<hr/>
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>  Manny Gimond (2019)
</br>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
